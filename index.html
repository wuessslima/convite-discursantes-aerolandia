<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Convite - Ala Aerol√¢ndia</title>
    <meta name="description" content="Gerador de convites para discursos sacramentais da Ala Aerol√¢ndia">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a4f72;
            --secondary-color: #2c6b9c;
            --accent-color: #8B4513;
            --background-color: #f8f9fa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Source Sans Pro', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-family: 'Playfair Display', serif;
        }
        
        .subtitle {
            color: var(--secondary-color);
            font-size: 1.1em;
        }
        
        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--secondary-color);
        }
        
        .preview-content {
            border: 2px dashed #ddd;
            padding: 30px;
            min-height: 500px;
            background: #fffef7;
            font-family: 'Times New Roman', serif;
            line-height: 1.8;
        }
        
        .pdf-version {
            font-family: 'Playfair Display', serif;
            text-align: center;
            background: white;
            padding: 40px 30px;
            border: 1px solid #e0e0e0;
        }
        
        .highlight {
            background-color: #fffacd;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-family: 'Playfair Display', serif;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }

        /* Estilos espec√≠ficos para a vers√£o PDF */
        .pdf-title {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            color: var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
        }

        .pdf-subtitle {
            font-family: 'Playfair Display', serif;
            font-size: 18px;
            color: var(--secondary-color);
            text-align: center;
            margin-bottom: 15px;
        }

        .pdf-text {
            font-family: 'Times New Roman', serif;
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 15px;
            text-align: justify;
        }

        .pdf-highlight {
            font-weight: bold;
            color: var(--primary-color);
            font-family: 'Playfair Display', serif;
        }

        .pdf-theme {
            font-family: 'Playfair Display', serif;
            font-size: 18px;
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid var(--accent-color);
        }

        .pdf-signature {
            text-align: center;
            margin-top: 30px;
            font-style: italic;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìÑ Gerador de Convites</h1>
            <p class="subtitle">Ala Aerol√¢ndia - Estaca Fortaleza Brasil</p>
            <p>Crie convites para discursos sacramentais de forma r√°pida e profissional</p>
        </header>
        
        <div class="content">
            <div class="card">
                <h2>üìù Preencha os Dados</h2>
                <div class="form-group">
                    <label for="nome">Nome Completo:</label>
                    <input type="text" id="nome" placeholder="Ex: Ana Clara Gomes Ribeiro">
                </div>
                
                <div class="form-group">
                    <label for="chamado">Chamado:</label>
                    <input type="text" id="chamado" placeholder="Ex: Secret√°ria das Mo√ßas">
                </div>
                
                <div class="form-group">
                    <label for="data">Data do Discurso:</label>
                    <input type="date" id="data">
                </div>
                
                <div class="form-group">
                    <label for="tema">Tema do Discurso:</label>
                    <input type="text" id="tema" placeholder="Ex: Aquele que Est√° Conosco">
                </div>
                
                <div class="form-group">
                    <label for="ordem">Ordem do Discurso:</label>
                    <select id="ordem">
                        <option value="Primeiro(a)">Primeiro(a)</option>
                        <option value="Segundo(a)">Segundo(a)</option>
                        <option value="Terceiro(a)">Terceiro(a)</option>
                    </select>
                </div>
                
                <div class="buttons">
                    <button class="btn btn-secondary" id="limpar">Limpar</button>
                    <button class="btn btn-primary" id="atualizar">Atualizar Visualiza√ß√£o</button>
                </div>
            </div>
            
            <div class="card">
                <h2>üëÅÔ∏è Pr√©-visualiza√ß√£o (Vers√£o PDF)</h2>
                <div class="preview-content">
                    <div id="convite-preview" class="pdf-version">
                        <!-- Conte√∫do ser√° gerado automaticamente -->
                    </div>
                </div>
                
                <div class="buttons">
                    <button class="btn btn-primary" id="gerar-pdf">üì• Baixar PDF</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>¬© 2024 Ala Aerol√¢ndia - Estaca Fortaleza Brasil | Ferramenta desenvolvida para auxiliar a lideran√ßa</p>
        </footer>
    </div>

    <script>
        // Elementos DOM
        const elements = {
            nome: document.getElementById('nome'),
            chamado: document.getElementById('chamado'),
            data: document.getElementById('data'),
            tema: document.getElementById('tema'),
            ordem: document.getElementById('ordem'),
            preview: document.getElementById('convite-preview'),
            atualizar: document.getElementById('atualizar'),
            gerarPdf: document.getElementById('gerar-pdf'),
            limpar: document.getElementById('limpar')
        };

        // Formatar data para portugu√™s
        function formatarData(data) {
            if (!data) return '[DATA]';
            
            const dataObj = new Date(data + 'T00:00:00');
            const options = { day: 'numeric', month: 'long', year: 'numeric' };
            return dataObj.toLocaleDateString('pt-BR', options);
        }

        // Atualizar preview com estilo melhorado para PDF
        function atualizarPreview() {
            const dados = {
                nome: elements.nome.value || '[NOME]',
                chamado: elements.chamado.value || '[CHAMADO]',
                data: formatarData(elements.data.value),
                tema: elements.tema.value || '[TEMA DO DISCURSO]',
                ordem: elements.ordem.value
            };

            elements.preview.innerHTML = `
                <div class="pdf-title">Convite para Discursar na Reuni√£o Sacramental</div>
                
                <div class="pdf-subtitle">A Igreja de Jesus Cristo dos Santos dos √öltimos Dias</div>
                <div class="pdf-subtitle">Ala Aerol√¢ndia ‚Äì Estaca Fortaleza Brasil</div>
                
                <div style="margin: 30px 0;"></div>
                
                <p class="pdf-text">
                    Prezado(a) irm√£o(√£) <span class="pdf-highlight">${dados.nome}</span>, 
                    no digno chamado de <span class="pdf-highlight">${dados.chamado}</span>,
                </p>
                
                <p class="pdf-text">
                    Voc√™ est√° cordialmente convidado(a) para discursar como 
                    <span class="pdf-highlight">${dados.ordem} Orador(a)</span> 
                    na Reuni√£o Sacramental do dia 
                    <span class="pdf-highlight">${dados.data}</span>.
                </p>
                
                <p class="pdf-text">
                    Esta √© uma valiosa oportunidade para edificar a f√© e fortalecer 
                    os membros de nossa ala atrav√©s de seu testemunho e experi√™ncias.
                </p>
                
                <div class="pdf-theme">
                    <strong>TEMA DO DISCURSO:</strong><br>
                    "<span style="color: var(--accent-color);">${dados.tema}</span>"
                </div>
                
                <p class="pdf-text">
                    Recomendamos o uso de escrituras sagradas para fundamentar sua mensagem 
                    e inspirar os ouvintes.
                </p>
                
                <p class="pdf-text">
                    Agradecemos antecipadamente por aceitar esta designa√ß√£o e oramos para 
                    que o Senhor o(a) aben√ßoe ricamente em sua prepara√ß√£o e apresenta√ß√£o.
                </p>
                
                <div class="pdf-signature">
                    <p>Com estima,</p>
                    <p><strong>Bispado da Ala Aerol√¢ndia</strong></p>
                    <p>Estaca Fortaleza Brasil</p>
                </div>
                
                <p class="pdf-text" style="text-align: center; margin-top: 20px; font-size: 14px; color: #666;">
                    Caso haja algum impedimento, solicitamos que nos avise com anteced√™ncia.
                </p>
            `;
        }

        // Gerar PDF com qualidade melhorada
        function gerarPDF() {
            const { jsPDF } = window.jspdf;
            
            // Configura√ß√µes para melhor qualidade
            const options = {
                scale: 2, // Maior resolu√ß√£o
                useCORS: true,
                allowTaint: true,
                logging: false
            };
            
            html2canvas(elements.preview, options).then(canvas => {
                const imgData = canvas.toDataURL('image/png', 1.0);
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgWidth = 190;
                const pageHeight = 280;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                let heightLeft = imgHeight;
                let position = 10;

                pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                // Adicionar p√°ginas se necess√°rio
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight + 10;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                // Nome do arquivo personalizado
                const fileName = elements.nome.value ? 
                    `Convite_${elements.nome.value.replace(/\s+/g, '_')}.pdf` : 
                    'Convite_Discurso_Sacramental.pdf';
                
                pdf.save(fileName);
            });
        }

        // Limpar formul√°rio
        function limparFormulario() {
            elements.nome.value = '';
            elements.chamado.value = '';
            elements.tema.value = '';
            elements.ordem.value = 'Primeiro(a)';
            elements.data.value = '2025-09-21';
            atualizarPreview();
        }

        // Event listeners
        elements.atualizar.addEventListener('click', atualizarPreview);
        elements.gerarPdf.addEventListener('click', gerarPDF);
        elements.limpar.addEventListener('click', limparFormulario);

        // Atualizar automaticamente
        ['input', 'change'].forEach(event => {
            elements.nome.addEventListener(event, atualizarPreview);
            elements.chamado.addEventListener(event, atualizarPreview);
            elements.data.addEventListener(event, atualizarPreview);
            elements.tema.addEventListener(event, atualizarPreview);
            elements.ordem.addEventListener(event, atualizarPreview);
        });

        // Inicializar
        window.addEventListener('load', () => {
            elements.data.value = '2025-09-21';
            atualizarPreview();
        });
    </script>
</body>
</html>

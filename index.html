<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Convite - Ala Aerol√¢ndia</title>
    <meta name="description" content="Gerador de convites para discursos sacramentais da Ala Aerol√¢ndia">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a4f72;
            --secondary-color: #2c6b9c;
            --accent-color: #8B4513;
            --background-color: #f8f9fa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Source Sans Pro', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden; /* Prevenir scroll lateral */
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
        }
        
        .subtitle {
            color: var(--secondary-color);
            font-size: 1.1em;
        }
        
        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 1024px) {
            .content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
        }
        
        .form-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            height: fit-content;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--secondary-color);
        }
        
        .preview-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden; /* Prevenir overflow */
        }
        
        .preview-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-color);
            font-family: 'Playfair Display', serif;
        }
        
        .pdf-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 400px;
            background: #f0f0f0;
            border: 2px dashed #ccc;
            padding: 20px;
            overflow: hidden;
            max-width: 100%;
        }
        
        .pdf-preview {
            width: 100%;
            max-width: 600px; /* Tamanho reduzido para caber na tela */
            height: 424px; /* Propor√ß√£o A4 paisagem reduzida (600/1.414) */
            background: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 30px;
            transform: scale(0.95);
            transform-origin: center;
        }
        
        .pdf-content {
            width: 100%;
            height: 100%;
            font-family: 'Playfair Display', serif;
            text-align: center;
            line-height: 1.6;
            padding: 20px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .pdf-title {
            font-size: 20px;
            color: var(--primary-color);
            margin-bottom: 15px;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 8px;
        }
        
        .pdf-subtitle {
            font-size: 16px;
            color: var(--secondary-color);
            margin-bottom: 12px;
        }
        
        .pdf-text {
            font-size: 14px;
            margin-bottom: 10px;
            text-align: center;
            line-height: 1.5;
        }
        
        .pdf-highlight {
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .pdf-theme {
            font-size: 16px;
            margin: 15px 0;
            padding: 12px;
            background: #f8f9fa;
            border: 1px solid var(--accent-color);
            border-radius: 5px;
        }
        
        .pdf-signature {
            margin-top: 20px;
            font-style: italic;
            color: #666;
            font-size: 14px;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 140px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }
        
        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
            
            .pdf-preview {
                max-width: 100%;
                height: 300px;
                padding: 15px;
                transform: scale(1);
            }
            
            .pdf-title {
                font-size: 18px;
            }
            
            .pdf-text, .pdf-theme {
                font-size: 12px;
            }
            
            .buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 200px;
            }
        }
        
        @media (max-width: 480px) {
            .pdf-preview {
                height: 250px;
                padding: 10px;
            }
            
            .pdf-content {
                padding: 10px;
            }
            
            .pdf-title {
                font-size: 16px;
                margin-bottom: 10px;
            }
            
            .pdf-text {
                font-size: 11px;
                margin-bottom: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìÑ Gerador de Convites</h1>
            <p class="subtitle">Ala Aerol√¢ndia - Estaca Fortaleza Brasil</p>
            <p>Crie convites para discursos sacramentais de forma r√°pida e profissional</p>
        </header>
        
        <div class="content">
            <!-- Se√ß√£o do Formul√°rio -->
            <div class="form-section">
                <h2>üìù Preencha os Dados</h2>
                <div class="form-group">
                    <label for="nome">Nome Completo:</label>
                    <input type="text" id="nome" placeholder="Ex: Ana Clara Gomes Ribeiro">
                </div>
                
                <div class="form-group">
                    <label for="chamado">Chamado:</label>
                    <input type="text" id="chamado" placeholder="Ex: Secret√°ria das Mo√ßas">
                </div>
                
                <div class="form-group">
                    <label for="data">Data do Discurso:</label>
                    <input type="date" id="data">
                </div>
                
                <div class="form-group">
                    <label for="tema">Tema do Discurso:</label>
                    <input type="text" id="tema" placeholder="Ex: Aquele que Est√° Conosco">
                </div>
                
                <div class="form-group">
                    <label for="ordem">Ordem do Discurso:</label>
                    <select id="ordem">
                        <option value="Primeiro(a)">Primeiro(a)</option>
                        <option value="Segundo(a)">Segundo(a)</option>
                        <option value="Terceiro(a)">Terceiro(a)</option>
                    </select>
                </div>
                
                <div class="buttons">
                    <button class="btn btn-secondary" id="limpar">Limpar</button>
                    <button class="btn btn-primary" id="atualizar">Atualizar Visualiza√ß√£o</button>
                </div>
            </div>
            
            <!-- Se√ß√£o de Pr√©-visualiza√ß√£o do PDF -->
            <div class="preview-section">
                <h2 class="preview-title">üëÅÔ∏è Pr√©-visualiza√ß√£o do PDF (Paisagem)</h2>
                <p style="text-align: center; margin-bottom: 15px; color: #666; font-size: 14px;">
                    Visualiza√ß√£o reduzida - O PDF final ser√° em tamanho A4 paisagem completo
                </p>
                
                <div class="pdf-container">
                    <div class="pdf-preview">
                        <div id="convite-preview" class="pdf-content">
                            <div style="color: #999; text-align: center; font-size: 12px;">
                                <p>Preencha os dados ao lado e clique em</p>
                                <p>"Atualizar Visualiza√ß√£o" para ver o convite</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="buttons">
                    <button class="btn btn-primary" id="gerar-pdf">üì• Baixar PDF em Paisagem</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>¬© 2024 Ala Aerol√¢ndia - Estaca Fortaleza Brasil | Ferramenta desenvolvida para auxiliar a lideran√ßa</p>
        </footer>
    </div>

    <script>
        // Elementos DOM
        const elements = {
            nome: document.getElementById('nome'),
            chamado: document.getElementById('chamado'),
            data: document.getElementById('data'),
            tema: document.getElementById('tema'),
            ordem: document.getElementById('ordem'),
            preview: document.getElementById('convite-preview'),
            atualizar: document.getElementById('atualizar'),
            gerarPdf: document.getElementById('gerar-pdf'),
            limpar: document.getElementById('limpar')
        };

        // Formatar data para portugu√™s
        function formatarData(data) {
            if (!data) return '[DATA]';
            
            const dataObj = new Date(data + 'T00:00:00');
            const options = { day: 'numeric', month: 'long', year: 'numeric' };
            return dataObj.toLocaleDateString('pt-BR', options);
        }

        // Atualizar preview em formato reduzido
        function atualizarPreview() {
            const dados = {
                nome: elements.nome.value || '[NOME]',
                chamado: elements.chamado.value || '[CHAMADO]',
                data: formatarData(elements.data.value),
                tema: elements.tema.value || '[TEMA DO DISCURSO]',
                ordem: elements.ordem.value
            };

            elements.preview.innerHTML = `
                <div class="pdf-title">Convite para Discursar na Reuni√£o Sacramental</div>
                
                <div class="pdf-subtitle">A Igreja de Jesus Cristo dos Santos dos √öltimos Dias</div>
                <div class="pdf-subtitle">Ala Aerol√¢ndia ‚Äì Estaca Fortaleza Brasil</div>
                
                <div style="margin: 10px 0;"></div>
                
                <p class="pdf-text">
                    Prezado(a) irm√£o(√£) <span class="pdf-highlight">${dados.nome}</span>, 
                    no digno chamado de <span class="pdf-highlight">${dados.chamado}</span>,
                </p>
                
                <p class="pdf-text">
                    Voc√™ est√° convidado(a) para discursar como 
                    <span class="pdf-highlight">${dados.ordem} Orador(a)</span> 
                    na Reuni√£o Sacramental do dia 
                    <span class="pdf-highlight">${dados.data}</span>.
                </p>
                
                <p class="pdf-text">
                    Esta √© uma oportunidade para edificar a f√© e fortalecer 
                    os membros de nossa ala.
                </p>
                
                <div class="pdf-theme">
                    <strong>TEMA DO DISCURSO:</strong><br>
                    "<span style="color: var(--accent-color);">${dados.tema}</span>"
                </div>
                
                <p class="pdf-text">
                    Recomendamos o uso de escrituras sagradas para fundamentar sua mensagem.
                </p>
                
                <p class="pdf-text">
                    Agradecemos por aceitar esta designa√ß√£o.
                </p>
                
                <div class="pdf-signature">
                    <p>Com estima,</p>
                    <p><strong>Bispado da Ala Aerol√¢ndia</strong></p>
                </div>
                
                <p style="text-align: center; margin-top: 10px; font-size: 11px; color: #666;">
                    Caso haja impedimento, avise com anteced√™ncia.
                </p>
            `;
        }

        // Gerar PDF em paisagem (tamanho real A4)
        function gerarPDF() {
            const { jsPDF } = window.jspdf;
            
            // Criar elemento tempor√°rio para o PDF em tamanho real
            const tempContainer = document.createElement('div');
            tempContainer.style.width = '297mm'; // Largura A4 paisagem
            tempContainer.style.height = '210mm'; // Altura A4 paisagem
            tempContainer.style.display = 'flex';
            tempContainer.style.justifyContent = 'center';
            tempContainer.style.alignItems: 'center';
            tempContainer.style.background = 'white';
            tempContainer.style.padding = '40px';
            tempContainer.style.position = 'absolute';
            tempContainer.style.left = '-9999px';
            
            const pdfContent = document.createElement('div');
            pdfContent.style.width = '100%';
            pdfContent.style.height = '100%';
            pdfContent.style.fontFamily = "'Playfair Display', serif";
            pdfContent.style.textAlign = 'center';
            pdfContent.style.lineHeight = '2.0';
            pdfContent.style.padding = '50px';
            pdfContent.style.display = 'flex';
            pdfContent.style.flexDirection = 'column';
            pdfContent.style.justifyContent = 'center';
            
            // Conte√∫do em tamanho real para o PDF
            const dados = {
                nome: elements.nome.value || '[NOME]',
                chamado: elements.chamado.value || '[CHAMADO]',
                data: formatarData(elements.data.value),
                tema: elements.tema.value || '[TEMA DO DISCURSO]',
                ordem: elements.ordem.value
            };

            pdfContent.innerHTML = `
                <div style="font-size: 32px; color: #1a4f72; margin-bottom: 30px; border-bottom: 3px solid #8B4513; padding-bottom: 15px;">
                    Convite para Discursar na Reuni√£o Sacramental
                </div>
                
                <div style="font-size: 20px; color: #2c6b9c; margin-bottom: 25px;">
                    A Igreja de Jesus Cristo dos Santos dos √öltimos Dias
                </div>
                <div style="font-size: 20px; color: #2c6b9c; margin-bottom: 40px;">
                    Ala Aerol√¢ndia ‚Äì Estaca Fortaleza Brasil
                </div>
                
                <p style="font-size: 18px; margin-bottom: 20px; text-align: center; line-height: 1.8;">
                    Prezado(a) irm√£o(√£) <strong style="color: #1a4f72;">${dados.nome}</strong>, 
                    no digno chamado de <strong style="color: #1a4f72;">${dados.chamado}</strong>,
                </p>
                
                <p style="font-size: 18px; margin-bottom: 20px; text-align: center; line-height: 1.8;">
                    Voc√™ est√° cordialmente convidado(a) para discursar como 
                    <strong style="color: #1a4f72;">${dados.ordem} Orador(a)</strong> 
                    na Reuni√£o Sacramental do dia 
                    <strong style="color: #1a4f72;">${dados.data}</strong>.
                </p>
                
                <p style="font-size: 18px; margin-bottom: 20px; text-align: center; line-height: 1.8;">
                    Esta √© uma valiosa oportunidade para edificar a f√© e fortalecer 
                    os membros de nossa ala atrav√©s de seu testemunho e experi√™ncias.
                </p>
                
                <div style="font-size: 22px; margin: 30px 0; padding: 20px; background: #f8f9fa; border: 2px solid #8B4513; border-radius: 8px;">
                    <strong>TEMA DO DISCURSO:</strong><br>
                    "<span style="color: #8B4513; font-size: 24px;">${dados.tema}</span>"
                </div>
                
                <p style="font-size: 18px; margin-bottom: 20px; text-align: center; line-height: 1.8;">
                    Recomendamos o uso de escrituras sagradas para fundamentar sua mensagem 
                    e inspirar os ouvintes.
                </p>
                
                <p style="font-size: 18px; margin-bottom: 20px; text-align: center; line-height: 1.8;">
                    Agradecemos antecipadamente por aceitar esta designa√ß√£o e oramos para 
                    que o Senhor o(a) aben√ßoe ricamente em sua prepara√ß√£o e apresenta√ß√£o.
                </p>
                
                <div style="margin-top: 40px; font-style: italic; color: #666; font-size: 18px;">
                    <p>Com estima,</p>
                    <p><strong>Bispado da Ala Aerol√¢ndia</strong></p>
                    <p>Estaca Fortaleza Brasil</p>
                </div>
                
                <p style="text-align: center; margin-top: 30px; font-size: 16px; color: #666;">
                    Caso haja algum impedimento, solicitamos que nos avise com anteced√™ncia.
                </p>
            `;
            
            tempContainer.appendChild(pdfContent);
            document.body.appendChild(tempContainer);
            
            // Gerar PDF
            html2canvas(tempContainer, {
                scale: 2,
                useCORS: true,
                logging: false,
                width: tempContainer.offsetWidth,
                height: tempContainer.offsetHeight
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png', 1.0);
                const pdf = new jsPDF('l', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                
                const imgWidth = pageWidth - 40;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                const x = 20;
                const y = (pageHeight - imgHeight) / 2;
                
                pdf.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);
                document.body.removeChild(tempContainer);
                
                const fileName = elements.nome.value ? 
                    `Convite_${elements.nome.value.replace(/\s+/g, '_')}.pdf` : 
                    'Convite_Discurso_Sacramental.pdf';
                
                pdf.save(fileName);
            });
        }

        // Limpar formul√°rio
        function limparFormulario() {
            elements.nome.value = '';
            elements.chamado.value = '';
            elements.tema.value = '';
            elements.ordem.value = 'Primeiro(a)';
            elements.data.value = '2025-09-21';
            atualizarPreview();
        }

        // Event listeners
        elements.atualizar.addEventListener('click', atualizarPreview);
        elements.gerarPdf.addEventListener('click', gerarPDF);
        elements.limpar.addEventListener('click', limparFormulario);

        // Atualizar automaticamente
        ['input', 'change'].forEach(event => {
            elements.nome.addEventListener(event, atualizarPreview);
            elements.chamado.addEventListener(event, atualizarPreview);
            elements.data.addEventListener(event, atualizarPreview);
            elements.tema.addEventListener(event, atualizarPreview);
            elements.ordem.addEventListener(event, atualizarPreview);
        });

        // Inicializar
        window.addEventListener('load', () => {
            elements.data.value = '2025-09-21';
            atualizarPreview();
        });
    </script>
</body>
</html>
